language: python
python:
    - "2.7"

# Cache PlatformIO packages using Travis CI container-based infrastructure
sudo: false
cache:
    directories:
        - "~/.platformio"

install:
    - pip install -U platformio
    - platformio update

script:
    - |
      if [[ "$FLASH" == "1" ]]; then
        platformio run -e esp32dev || exit 1
      fi
    - |
      if [[ "$SNIFF" == "1" ]]; then
        platformio check -e esp32dev || exit 1
      fi

jobs:
    include:
        - name: Flash Arduino
          env: FLASH=1
        - name: Lint
          env: SNIFF=1